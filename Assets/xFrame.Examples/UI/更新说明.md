# UIç»„ä»¶ç³»ç»Ÿæ›´æ–°è¯´æ˜

## ğŸ‰ v2.0 - å¤šç•Œé¢åˆ‡æ¢ç³»ç»Ÿ (2024-12-01)

### æ–°åŠŸèƒ½ï¼šTabç³»ç»Ÿ

æ–°å¢äº†å®Œæ•´çš„å¤šç•Œé¢åˆ‡æ¢ç³»ç»Ÿï¼Œæ”¯æŒæ¸¸æˆä¸­ä¸»é¡µçš„å¤šä¸ªé¡µç­¾åˆ‡æ¢åŠŸèƒ½ã€‚

#### æ ¸å¿ƒç»„ä»¶
- âœ… **UITabPage** - æ ‡ç­¾é¡µåŸºç±»ï¼Œæ—¢å¯ç‹¬ç«‹ä½¿ç”¨åˆå¯ä½œä¸ºå®¹å™¨å­é¡µé¢
- âœ… **UITabContainer** - æ ‡ç­¾é¡µå®¹å™¨ï¼Œä½¿ç”¨ç»„åˆæ¨¡å¼ç®¡ç†å¤šä¸ªTabPage
- âœ… **UITabButton** - æ ‡ç­¾æŒ‰é’®ç»„ä»¶ï¼Œç”¨äºåˆ‡æ¢é¡µé¢
- âœ… **UITabContainerBuilder** - æ„å»ºå™¨ï¼Œæä¾›æµå¼APIç®€åŒ–å®¹å™¨æ„å»º

#### æ ¸å¿ƒç‰¹æ€§
- âœ… ç»„åˆæ¨¡å¼ç®¡ç†çˆ¶å­UIç”Ÿå‘½å‘¨æœŸ
- âœ… å­é¡µé¢å¯ç‹¬ç«‹ä½¿ç”¨æˆ–ä½œä¸ºå®¹å™¨ä¸€éƒ¨åˆ†ï¼ˆå¯¹å­é¡µé¢æ— æ„Ÿï¼‰
- âœ… æ”¯æŒç´¢å¼•ã€ç±»å‹ã€åç§°å¤šç§æ–¹å¼åˆ‡æ¢é¡µé¢
- âœ… é¡µé¢åˆ‡æ¢äº‹ä»¶é€šçŸ¥
- âœ… Builderæ¨¡å¼ç®€åŒ–å®¹å™¨æ„å»º

#### æ–°å¢æ–‡ä»¶
- `UITabPage.cs` - æ ‡ç­¾é¡µåŸºç±»
- `UITabContainer.cs` - æ ‡ç­¾é¡µå®¹å™¨
- `UITabButton.cs` - æ ‡ç­¾æŒ‰é’®ç»„ä»¶
- `UITabContainerBuilder.cs` - å®¹å™¨æ„å»ºå™¨
- `TabSystemExample.cs` - å®Œæ•´ç¤ºä¾‹
- `å¤šç•Œé¢åˆ‡æ¢ç³»ç»Ÿæ–‡æ¡£.md` - è¯¦ç»†è®¾è®¡æ–‡æ¡£
- `Tabç³»ç»Ÿå¿«é€Ÿå¼€å§‹.md` - å¿«é€Ÿå…¥é—¨æŒ‡å—

#### ä½¿ç”¨ç¤ºä¾‹
```csharp
// åˆ›å»ºå®¹å™¨
var container = Instantiate(containerPrefab);

// æ·»åŠ é¡µé¢
container.AddPage(Instantiate(homePagePrefab));
container.AddPage(Instantiate(inventoryPagePrefab));
container.AddPage(Instantiate(shopPagePrefab));

// åˆ‡æ¢é¡µé¢
container.SwitchPage(0);                    // é€šè¿‡ç´¢å¼•
container.SwitchPage<InventoryPage>();      // é€šè¿‡ç±»å‹
container.SwitchPage("ShopPage");           // é€šè¿‡åç§°
```

---

## ğŸ”„ v1.0 - ä¾èµ–å…³ç³»è°ƒæ•´

ä¾èµ–å…³ç³»å·²ä» **"å­ç»„ä»¶çŸ¥é“çˆ¶ç»„ä»¶"** è°ƒæ•´ä¸º **"çˆ¶ç»„ä»¶çŸ¥é“å­ç»„ä»¶"**

---

## âœ… è°ƒæ•´å†…å®¹

### 1. æ ¸å¿ƒç±»ä¿®æ”¹

#### UIComponent.cs
- âŒ ç§»é™¤ `ParentView` å±æ€§
- âŒ ç§»é™¤ `SendEventToParent<T>()` æ–¹æ³•
- âŒ ç§»é™¤ `SendMessageToParent<T>()` æ–¹æ³•
- âŒ ç§»é™¤ `IUIMessageReceiver<T>` æ¥å£
- âœ… æ–°å¢ `SendEvent<T>()` æ–¹æ³•ï¼ˆå‘é€å…¨å±€äº‹ä»¶ï¼‰
- âœ… `Initialize()` ä¸å†éœ€è¦ parentView å‚æ•°

#### UIComponentManager.cs
- âŒ ç§»é™¤æ„é€ å‡½æ•°çš„ `parentView` å‚æ•°
- âœ… `AutoRegisterComponents()` éœ€è¦ä¼ å…¥ `rootTransform` å‚æ•°
- âœ… ä¸å†å­˜å‚¨çˆ¶ç»„ä»¶å¼•ç”¨

### 2. ç¤ºä¾‹ä»£ç ä¿®æ”¹

æ‰€æœ‰ç¤ºä¾‹ä»£ç å·²æ›´æ–°ï¼š
- `ItemSlotComponent.cs` - ä½¿ç”¨ `SendEvent()`
- `InventoryPanel.cs` - æŒæœ‰å­ç»„ä»¶å¼•ç”¨åˆ—è¡¨
- `UIComponentUsageExample.cs` - å±•ç¤ºæ­£ç¡®çš„é€šè®¯æ–¹å¼
- `SkillButtonComponent` - ä½¿ç”¨ `SendEvent()`

### 3. æ–‡æ¡£æ›´æ–°

æ‰€æœ‰æ–‡æ¡£å·²æ›´æ–°ï¼š
- `UIç»„ä»¶å¤ç”¨è®¾è®¡.md` - å®Œæ•´è®¾è®¡æ–‡æ¡£
- `ç»„ä»¶ç³»ç»Ÿå¿«é€Ÿå¼€å§‹.md` - å¿«é€Ÿå…¥é—¨æŒ‡å—
- `UIæ¡†æ¶.md` - ä¸»æ–‡æ¡£
- `ä¾èµ–å…³ç³»è¯´æ˜.md` - æ–°å¢ä¾èµ–å…³ç³»è¯¦ç»†è¯´æ˜

---

## ğŸ¯ æ–°çš„ä¾èµ–å…³ç³»

### çˆ¶ç»„ä»¶ â†’ å­ç»„ä»¶

```csharp
public class InventoryPanel : UIPanel
{
    // âœ… çˆ¶ç»„ä»¶æŒæœ‰å­ç»„ä»¶å¼•ç”¨
    private List<ItemSlotComponent> _slots = new List<ItemSlotComponent>();
    
    protected override void OnCreate()
    {
        // âœ… çˆ¶ç»„ä»¶åˆ›å»ºå’Œç®¡ç†å­ç»„ä»¶
        for (int i = 0; i < 20; i++)
        {
            var slot = Instantiate(slotPrefab);
            ComponentManager.RegisterComponent(slot);
            _slots.Add(slot);  // æŒæœ‰å¼•ç”¨
        }
    }
    
    // âœ… çˆ¶ç»„ä»¶å¯ä»¥ç›´æ¥è°ƒç”¨å­ç»„ä»¶æ–¹æ³•
    public void SelectSlot(int index)
    {
        _slots[index].SetSelected(true);
        _slots[index].Show();
    }
}
```

### å­ç»„ä»¶ â†’ äº‹ä»¶æ€»çº¿

```csharp
public class ItemSlotComponent : UIComponent
{
    // âœ… å­ç»„ä»¶ä¸æŒæœ‰çˆ¶ç»„ä»¶å¼•ç”¨
    // âŒ ä¸å­˜åœ¨ ParentView å±æ€§
    
    private void OnClicked()
    {
        // âœ… å‘é€å…¨å±€äº‹ä»¶ï¼ˆä¸çŸ¥é“è°åœ¨ç›‘å¬ï¼‰
        SendEvent(new ItemClickedEvent { ... });
    }
}
```

### çˆ¶ç»„ä»¶æ¥æ”¶äº‹ä»¶

```csharp
public class InventoryPanel : UIPanel
{
    protected override void OnCreate()
    {
        // âœ… è®¢é˜…å…¨å±€äº‹ä»¶
        xFrameEventBus.SubscribeTo<UIComponentEventWrapper<ItemClickedEvent>>(
            OnItemClicked);
    }
    
    private void OnItemClicked(ref UIComponentEventWrapper<ItemClickedEvent> evt)
    {
        // âœ… é€šè¿‡ComponentIdè¯†åˆ«æ˜¯å“ªä¸ªå­ç»„ä»¶
        var slot = ComponentManager.GetComponent<ItemSlotComponent>(evt.ComponentId);
        
        // âœ… æˆ–è€…ç›´æ¥ä½¿ç”¨SourceComponent
        var slot2 = evt.SourceComponent as ItemSlotComponent;
        
        // âœ… ç›´æ¥è°ƒç”¨å­ç»„ä»¶æ–¹æ³•
        slot.SetSelected(true);
    }
}
```

---

## ğŸŒŸ æ ¸å¿ƒä¼˜åŠ¿

### 1. ç¬¦åˆè®¾è®¡æ¨¡å¼
- âœ… éµå¾ªç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰
- âœ… çˆ¶èŠ‚ç‚¹æŒæœ‰å­èŠ‚ç‚¹å¼•ç”¨
- âœ… å­èŠ‚ç‚¹ä¸æŒæœ‰çˆ¶èŠ‚ç‚¹å¼•ç”¨

### 2. é™ä½è€¦åˆ
- âœ… å­ç»„ä»¶ä¸ä¾èµ–å…·ä½“çš„çˆ¶ç»„ä»¶ç±»å‹
- âœ… å­ç»„ä»¶å¯ä»¥åœ¨ä»»ä½•çˆ¶ç»„ä»¶ä¸­å¤ç”¨
- âœ… å­ç»„ä»¶ä¿æŒç‹¬ç«‹æ€§å’Œçº¯ç²¹æ€§

### 3. æ¸…æ™°çš„æ§åˆ¶æƒ
- âœ… çˆ¶ç»„ä»¶æ‹¥æœ‰æ§åˆ¶æƒ
- âœ… çˆ¶ç»„ä»¶ç®¡ç†å­ç»„ä»¶çš„åˆ›å»ºã€é”€æ¯ã€ç”Ÿå‘½å‘¨æœŸ
- âœ… çˆ¶ç»„ä»¶åè°ƒå¤šä¸ªå­ç»„ä»¶ä¹‹é—´çš„äº¤äº’

### 4. å•å‘æ•°æ®æµ
- âœ… çˆ¶ â†’ å­ï¼šç›´æ¥è°ƒç”¨æ–¹æ³•
- âœ… å­ â†’ çˆ¶ï¼šé€šè¿‡äº‹ä»¶é€šçŸ¥
- âœ… æ•°æ®æµå‘æ¸…æ™°æ˜ç¡®

---

## ğŸ“š è¿ç§»æŒ‡å—

å¦‚æœä½ æœ‰åŸºäºæ—§ç‰ˆæœ¬çš„ä»£ç ï¼Œéœ€è¦åšä»¥ä¸‹è°ƒæ•´ï¼š

### 1. ç§»é™¤å­ç»„ä»¶ä¸­çš„çˆ¶ç»„ä»¶å¼•ç”¨

```csharp
// âŒ æ—§ä»£ç 
public class MyComponent : UIComponent
{
    private void DoSomething()
    {
        if (ParentView is MyPanel panel)
        {
            panel.HandleEvent();
        }
    }
}

// âœ… æ–°ä»£ç 
public class MyComponent : UIComponent
{
    private void DoSomething()
    {
        SendEvent(new MyComponentEvent { ... });
    }
}
```

### 2. ä¿®æ”¹äº‹ä»¶å‘é€æ–¹å¼

```csharp
// âŒ æ—§ä»£ç 
SendEventToParent(new ItemClickedEvent { ... });

// âœ… æ–°ä»£ç 
SendEvent(new ItemClickedEvent { ... });
```

### 3. çˆ¶ç»„ä»¶æŒæœ‰å­ç»„ä»¶å¼•ç”¨

```csharp
// âœ… æ–°ä»£ç ï¼šçˆ¶ç»„ä»¶æŒæœ‰å¼•ç”¨
public class MyPanel : UIPanel
{
    private List<MyComponent> _components = new List<MyComponent>();
    
    protected override void OnCreate()
    {
        for (int i = 0; i < 10; i++)
        {
            var comp = Instantiate(prefab);
            ComponentManager.RegisterComponent(comp);
            _components.Add(comp);  // æŒæœ‰å¼•ç”¨
        }
    }
    
    // å¯ä»¥ç›´æ¥æ“ä½œ
    public void HideAll()
    {
        foreach (var comp in _components)
        {
            comp.Hide();
        }
    }
}
```

---

## ğŸ“– å‚è€ƒæ–‡æ¡£

- **ä¾èµ–å…³ç³»è¯¦è§£**: `ä¾èµ–å…³ç³»è¯´æ˜.md`
- **å®Œæ•´è®¾è®¡æ–‡æ¡£**: `UIç»„ä»¶å¤ç”¨è®¾è®¡.md`
- **å¿«é€Ÿå…¥é—¨**: `ç»„ä»¶ç³»ç»Ÿå¿«é€Ÿå¼€å§‹.md`
- **ç¤ºä¾‹ä»£ç **: `InventoryPanel.cs`, `ItemSlotComponent.cs`

---

## âœ¨ æ€»ç»“

æ–°çš„ä¾èµ–å…³ç³»è®¾è®¡è®©UIç»„ä»¶ç³»ç»Ÿæ›´åŠ ï¼š
- âœ… **å¥å£®** - ç¬¦åˆç»å…¸è®¾è®¡æ¨¡å¼
- âœ… **çµæ´»** - å­ç»„ä»¶é«˜åº¦å¯å¤ç”¨
- âœ… **æ¸…æ™°** - èŒè´£æ˜ç¡®ï¼Œæ•°æ®æµå‘æ˜ç¡®
- âœ… **æ˜“ç»´æŠ¤** - ä½è€¦åˆï¼Œé«˜å†…èš

è¿™æ˜¯æ›´å¥½çš„è®¾è®¡ï¼ğŸ‰
